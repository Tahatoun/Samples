public class FakeServiceProvider : IServiceProvider
{
    private readonly Dictionary<Type, object> _services = new();

    public void Add<T>(T instance) => _services[typeof(T)] = instance;

    public object? GetService(Type serviceType)
    {
        return _services.TryGetValue(serviceType, out var service)
            ? service
            : null;
    }
}