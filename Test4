public static DateTime ParseExcelDate(object value)
{
    if (value == null)
        throw new ArgumentNullException(nameof(value));

    if (value is double excelSerialNumber)
    {
        // Excel stocke les dates en tant que nombres Ã  partir du 1er janvier 1900
        return DateTime.FromOADate(excelSerialNumber);
    }

    if (value is int excelInt)
    {
        return DateTime.FromOADate(excelInt);
    }

    if (value is string str)
    {
        if (DateTime.TryParse(str, out var result))
        {
            return result;
        }

        throw new FormatException($"String '{str}' is not a valid date format.");
    }

    throw new FormatException($"Unsupported type: {value.GetType()}");
}